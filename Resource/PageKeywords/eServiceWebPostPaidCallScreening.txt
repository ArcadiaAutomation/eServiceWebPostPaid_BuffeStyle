*** Settings ***
Resource          eServiceWebPostPaidLogin.txt
Resource          eServiceWebPostPaidCommon.txt
Resource          ../PageRepository/eServiceWebPostPaidRepository.txt
Resource          ../PageRepository/eServiceWebPostPaidCallScreeningRepository.txt
Resource          ../Localized/${ar_LANG}/eServiceWebPostPaidCallScreening.txt

*** Keywords ***
Set Status Inactive Welcome Calls
    Click Web Element    ${btnSelectStatusInactive}
    Click Web Element    ${btnCallScreeningStatusRegister}
    ${result}    Run Keyword And Return Status    Wait Until Element Is Visible    ${txtSummaryMessage}    2
    Log To Console    ${result}
    Run Keyword If    '${result}'=='False'    Click Web Element    ${btnCloseCallScreeningDialog}
    Run Keyword If    '${result}'=='True'    Confirm Status

Set Status Active Welcome Calls
    Click Web Element    ${btnSelectStatusActive}
    Click Web Element    ${btnCallScreeningStatusRegister}
    ${result}    Run Keyword And Return Status    Wait Until Element Is Visible    ${txtSummaryMessage}    2
    Log To Console    ${result}
    Run Keyword If    '${result}'=='False'    Click Web Element    ${btnCloseCallScreeningDialog}
    Run Keyword If    '${result}'=='True'    Confirm Status

Confirm Status
    Click Web Element    ${btnConfirmCallScreeningDialog}
    Click Web Element    ${btnBackToCallScreeningDialog}

Check Register
    ${result}    Run Keyword And Return Status    Web Element Text Should Be    ${txtCheckConfirmRegister}    ${checkConfirm}
    Log To Console    ${result}
    Run Keyword If    '${result}'=='True'    Confirm Register

Confirm Register
    Click Web Element    ${btnCallScreeningRegisterConfirm}
    Click Web Element    ${btnConfirmCallscreenRegister}
    @{MessageExpect}    Create List    ${smsCheckCallScreening}
    Open SMS App    ${virtual_3PO_1_IPAppium}    ${virtual_3PO_1_Platfrom_Name}    ${virtual_3PO_1_Platfrom_Version}    ${virtual_3PO_1_SN}
    Wait and Verify SMS    ${virtual_3PO_1_Platfrom_Name}    1    AIS    ${MessageExpect}    30
    Click Web Element    ${btnBackToCallScreeningDialog}

Clear Number Block Calls
    Click Web Element    ${tabBlockCalls}
    Click Web Element    ${btnRemoveNumberBlockCalls}
    Click Web Element    ${btnConfirmBlockCalls}
    Click Web Element    ${btnConfirmCallScreeningDialog}
    Click Web Element    ${btnBackToCallScreeningDialog}

Clear Number Welcome Calls
    @{txtWelcomeCallNumber}    Get Webelements    xpath=//*[@class="mpay_input ng-pristine ng-valid"]
    Comment    @{btnRemoveNumberWelcomeCallNumber}    Get Webelements    xpath=//*[@class="button_all color_orange1 l_gap10 btn_mini"]
    :FOR    ${index}    IN RANGE    0    19
    \    Run Keyword If    @{txtWelcomeCallNumber}[${index}]==NULL    Exit For Loop
    Click Web Element    ${btnConfirmWelcomeCalls}
    Click Web Element    ${btnConfirmCallScreeningDialog}
    Click Web Element    ${btnBackToCallScreeningDialog}

Add Number One
    Input Web Text    ${txtInputNumberMobile}    0924260606
    Click Web Element    ${btnAddNumber}

Add Number Two
    Input Web Text    ${txtInputNumberMobile}    0817112144
    Click Web Element    ${btnAddNumber}

Verify List Number Welcome Calls
    @{txtWelcomeCallNumber}    Get Webelements    xpath=//*[@class="mpay_input ng-pristine ng-valid"]
    :FOR    ${index}    IN RANGE    0    19
    \    Run Keyword If    @{txtWelcomeCallNumber}[${index}]    Exit For Loop
    Log    ${index}
