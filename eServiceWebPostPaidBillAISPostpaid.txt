*** Settings ***
Resource          Resource/PageKeywords/eServiceWebPostPaidBillAISPostpaid.txt
Resource          ../LocalConfig.txt

*** Test Cases ***
[S05-001]eServiceWeb-PO-BillAISPostpaid-PayWithMASTERcard
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Login    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1_Number}
    SelectMenu    Payment/Topup    BillAISPostpaid
    sleep    5
    Select Payment Type    ${CreditCard}
    Select Card Name    MASTER
    Click Web Element    ${btnOK}
    sleep    5
    Select Window    url=${urlIpayBangkokBank}
    ${currentURL}    Get Location
    Run Keyword if    '${currentURL}' != '${urlIpayBangkokBank}'    Fail
    Close All Browsers

[S05-002]eServiceWeb-PO-BillAISPostpaid-PayWithVISAcard
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Login    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1_Number}
    SelectMenu    Payment/Topup    BillAISPostpaid
    sleep    5
    Select Payment Type    ${CreditCard}
    Select Card Name    VISA
    Click Web Element    ${btnOK}
    sleep    5
    Select Window    url=${urlIpayBangkokBank}
    ${currentURL}    Get Location
    Run Keyword if    '${currentURL}' != '${urlIpayBangkokBank}'    Fail
    Close All Browsers

[S05-003]eServiceWeb-PO-BillAISPostpaid-PayWithAMEXcard
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Login    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1_Number}
    SelectMenu    Payment/Topup    BillAISPostpaid
    sleep    5
    Select Payment Type    ${CreditCard}
    Select Card Name    AMEX
    Click Web Element    ${btnOK}
    sleep    5
    Element Should Be Visible    ${imgAMEXCard}
    Close All Browsers

[S05-004]eServiceWeb-PO-BillAISPostpaid-PayWithDebitcard
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Login    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1_Number}
    SelectMenu    Payment/Topup    BillAISPostpaid
    sleep    5
    Select Payment Type    ${DebitCard}
    Click Web Element    ${btnOK}
    sleep    5
    Select Window    url=${urlIpayBangkokBank}
    ${currentURL}    Get Location
    Run Keyword if    '${currentURL}' != '${urlIpayBangkokBank}'    Fail
    Close All Browsers

[S05-005]eServiceWeb-PO-BillAISPostpaid-PayWithDirectDebit-KTC
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Login    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1_Number}
    SelectMenu    Payment/Topup    BillAISPostpaid
    sleep    5
    Select Payment Type    ${DirectDebit}
    Select Card Name    ${KrungthaiBank}
    Click Web Element    ${btnOK}
    sleep    5
    Select Window    url=${urlKTBbank}
    ${currentURL}    Get Location
    Run Keyword if    '${currentURL}' != '${urlKTBbank}'    Fail
    Close All Browsers

[S05-006]eServiceWeb-PO-BillAISPostpaid-PayWithDirectDebit-ThanachartBank
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Login    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1_Number}
    SelectMenu    Payment/Topup    BillAISPostpaid
    sleep    5
    Select Payment Type    ${DirectDebit}
    Select Card Name    ${ThanachartBank}
    Click Web Element    ${btnOK}
    sleep    5
    Select Window    url=${urlThanachartBank}
    ${currentURL}    Get Location
    Run Keyword if    '${currentURL}' != '${urlThanachartBank}'    Fail
    Close All Browsers

[S05-007]eServiceWeb-PO-BillAISPostpaid-PayWithDirectDebit-SCB
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Login    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1_Number}
    SelectMenu    Payment/Topup    BillAISPostpaid
    sleep    5
    Select Payment Type    ${DirectDebit}
    Select Card Name    ${SiamCommercialBank}
    Click Web Element    ${btnOK}
    sleep    5
    Select Window    url=${urlSCBbank}
    ${currentURL}    Get Location
    Run Keyword if    '${currentURL}' != '${urlSCBbank}'    Fail
    Close All Browsers

[S05-008]eServiceWeb-PO-BillAISPostpaid-PayWithDirectDebit-UOB
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Login    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1_Number}
    SelectMenu    Payment/Topup    BillAISPostpaid
    sleep    5
    Select Payment Type    ${DirectDebit}
    Select Card Name    ${UnitedOverseaBank}
    Click Web Element    ${btnOK}
    sleep    5
    Select Window    url=${urlUOBbank}
    ${currentURL}    Get Location
    Run Keyword if    '${currentURL}' != '${urlUOBbank}'    Fail
    Close All Browsers

[S05-009]eServiceWeb-PO-BillAISPostpaid-PayWithDirectDebit-Krungsriayudhya
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Login    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1_Number}
    SelectMenu    Payment/Topup    BillAISPostpaid
    sleep    5
    Select Payment Type    ${DirectDebit}
    Select Card Name    ${KrungsriayudhyaBank}
    Click Web Element    ${btnOK}
    sleep    5
    Select Window    url=${urlKrungsriBank}
    ${currentURL}    Get Location
    Run Keyword if    '${currentURL}' != '${urlKrungsriBank}'    Fail
    Close All Browsers

[S05-010]eServiceWeb-PO-BillAISPostpaid-PayWithDirectDebit-ThaiMilitaryBank
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Login    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1_Number}
    SelectMenu    Payment/Topup    BillAISPostpaid
    sleep    5
    Select Payment Type    ${DirectDebit}
    Select Card Name    ${ThaiMilitaryBank}
    Click Web Element    ${btnOK}
    sleep    5
    Select Window    url=${urlTMBbank}
    ${currentURL}    Get Location
    Run Keyword if    '${currentURL}' != '${urlTMBbank}'    Fail
    Close All Browsers

TestOpenAppMobile
    ${driver1}    AISAppium Open Application    http://10.239.223.84:4723/wd/hub    platformName=Android    platformVersion=5.1.1    deviceName= any    appPackage=com.ais.mimo.eservice
    ...    appActivity=com.nextzy.allforone.view.DummyActivity    appWaitActivity=com.nextzy.allforone.view.menu.MenuActivity    udid=9201176364de23eb
    ${driver2}    AISAppium Open Application    http://10.239.223.84:4724/wd/hub    platformName=Android    platformVersion=5.1.1    deviceName= any    appPackage=com.calea.echo
    ...    appActivity=com.calea.echo.MainActivity    udid=0123456789ABCDEF
    log    ${driver1}
    log    ${driver2}
    AISAppium Click Element    name=AIS
    AISAppium Set Network Connection Status    1    ${driver2}

TesteServiceMobile-PO-Login
    ${App1}    AISAppium Open Application    http://10.239.223.84:4724/wd/hub    platformName=Android    platformVersion=5.1.1    deviceName= any    appPackage=com.ais.mimo.eservice
    ...    appActivity=com.nextzy.allforone.view.DummyActivity    appWaitActivity=com.nextzy.allforone.view.menu.MenuActivity    udid=0123456789ABCDEF
    ${App2}    AISAppium Open Application    http://10.239.223.84:4723/wd/hub    platformName=Android    platformVersion=5.1.1    deviceName= any    appPackage=com.calea.echo
    ...    appActivity=com.calea.echo.MainActivity    udid=4d00643b4828a0df
    sleep    5
    AISAppium Click Element    xpath=//android.widget.ImageView[@content-desc="eService"]    ${App1}
    sleep    5
    Comment    Mobile Set Network Connection Status    6    ${App1}
    AISAppium Input Text    xpath=//*[@resource-id="com.ais.mimo.eservice:id/edt_mobile_number"]    0613851273    ${App1}
    AISAppium Hide Keyboard    ${App1}
    sleep    5
    AISAppium Click Element    xpath=//*[@resource-id="com.ais.mimo.eservice:id/btn_submit_mobile_number"]    ${App1}
    sleep    5
    AISAppium Click Element    name=AIS    ${App2}
    sleep    5
    @{SMS}    AISAppium Get Elements Attribute    xpath=//*[@resource-id="com.calea.echo:id/imm_text"]    text    ${App2}
    Log    @{SMS}[0]
    @{OTP}=    Get Regexp Matches    @{SMS}[0]    \\d\\d\\d\\d
    AISAppium Input Text    xpath=//*[@resource-id="com.ais.mimo.eservice:id/edt_otp_number"]    @{OTP}[0]    ${App1}
    AISAppium Hide Keyboard    ${App1}
    AISAppium Click Element    xpath=//*[@resource-id="com.ais.mimo.eservice:id/btn_submit_password"]    ${App1}

TestInfo
    ${App1}    AISAppium Open Application    http://10.239.223.84:4724/wd/hub    platformName=Android    platformVersion=5.1.1    deviceName= any    appPackage=com.ais.mimo.eservice
    ...    appActivity=com.nextzy.allforone.view.DummyActivity    appWaitActivity=com.nextzy.allforone.view.menu.MenuActivity    udid=0123456789ABCDEF
    ${App2}    AISAppium Open Application    http://10.239.223.84:4723/wd/hub    platformName=Android    platformVersion=5.1.1    deviceName= any    appPackage=com.calea.echo
    ...    appActivity=com.calea.echo.MainActivity    udid=4d00643b4828a0df
    sleep    5
    Log    ${App1.driver}
    Log    ${App2.index}
    AISAppium Click Element    name=AIS
    AISAppium Click Element    xpath=//android.widget.ImageView[@content-desc="eService"]    ${App1}
