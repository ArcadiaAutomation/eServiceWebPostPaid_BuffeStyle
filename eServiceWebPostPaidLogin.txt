*** Settings ***
Test Teardown
Resource          Resource/PageKeywords/eServiceWebPostPaidLogin.txt
Resource          ../Config/LocalConfig.txt

*** Test Cases ***
test
    [Tags]    test
    Take And Define Virtual Local Configuration    ${gn_local_config_file_path}    lo_3PO_1    ${gn_parallel_timeout}
    &{#list_device_name}=    Create Dictionary    ${lo_3PO_1_#device_name}=${lo_3PO_1_#timestamp}
    Comment    Log    ${lo_3PO_1_SN}
    Comment    Log    @{lo_3PO_1_ExampleList}[1]
    Comment    Log    &{lo_3PO_1_ExampleDic}[name1]
    Comment    Open SMS App    ${lo_3PO_1_IPAppium}    ${lo_3PO_1_Platfrom_Name}    ${lo_3PO_1_Platfrom_Version}    ${lo_3PO_1_SN}
    Comment    Release Virtual Local Config    ${gn_local_config_file_path}    ${lo_3PO_1_#device_name}
    Comment    Wait SMS    ${lo_3PO_1_Platfrom_Name}    1    60
    Comment    ${messages}=    Read SMS    ${lo_3PO_1_Platfrom_Name}    AIS    1
    Comment    Log List    ${messages}
    Comment    ${temp}=    Set Variable    @{messages}[0]
    Comment    Log    ${temp}
    Comment    Log    Finish...
    Comment    ${app1}=    Open Application    http://10.239.223.104:4725/wd/hub    platformName=Android    platformVersion=5.0.2    udid=2a82ee4d
    ...    appPackage=com.ais.mimo.eservice    appActivity=com.nextzy.allforone.view.DummyActivity    appWaitActivity=com.nextzy.allforone.view.menu.MenuActivity    deviceName=10.239.223.104:4723
    Comment    sleep    3
    Comment    AppiumLibrary.Click Element    xpath=//android.widget.ImageView[@content-desc="eService"]
    Comment    sleep    3
    Comment    ${app2}=    Open Application    http://10.239.223.104:4723/wd/hub    platformName=Android    platformVersion=5.0.2    udid=2a82ee4d
    ...    appPackage=com.calea.echo    appActivity=com.calea.echo.MainActivity    deviceName=10.239.223.104:4723
    Comment    sleep    5
    Comment    Switch Application    ${app1}
    Comment    sleep    3
    Comment    ${#device_name}=    Set Variable    Test
    Comment    Log    ${#device_name}
    [Teardown]    Release Virtual Local Configurations    ${gn_local_config_file_path}    &{#list_device_name}

[F01-001]eServiceWeb-PO-Login-NumberNotComplete
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    090546798
    Click Web Element    ${btnGetOTP}
    Element Text Should Be    ${lblDialogMessage}    ${MessageNumberNotComplete}
    Click Web Element    ${btnDialogClose}
    Close Browser
    [Teardown]

[F01-002]eServiceWeb-PO-Login-NumberDtac
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    0944835961
    Click Web Element    ${btnGetOTP}
    Wait Web Until Page Contains Element    ${ttMessage}
    Element Text Should Be    ${ttMessage}    ${MessageNumberDtac}
    Close Browser
    [Teardown]

[F01-003]eServiceWeb-PO-Login-OtpNotcomplete
    Take And Define Virtual Local Configuration    ${lo_local_config_file_path}    lo_3PO_1    ${lo_parallel_timeout}
    &{#list_device_name}=    Create Dictionary    ${lo_3PO_1_#device_name}=${lo_3PO_1_#timestamp}
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    ${lo_3PO_1_Number}
    Click Web Element    ${btnGetOTP}
    Sleep    5
    Input Web Text    ${txtInputOTP}    123
    Element Should Be Visible    ${btnOKOTPDisable}
    Sleep    2
    Close Browser
    Open SMS App    ${lo_3PO_1_IPAppium}    ${lo_3PO_1_Platfrom_Name}    ${lo_3PO_1_Platfrom_Version}    ${lo_3PO_1_SN}
    Clear All Unread SMS    ${lo_3PO_1_Platfrom_Name}
    AISAppiumEx.Close All Applications
    [Teardown]    Release Virtual Local Configurations    ${lo_local_config_file_path}    &{#list_device_name}

[F01-004]eServiceWeb-PO-Login-InputWrongOtp
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    ${lo_3PO_1_Number}
    Click Web Element    ${btnGetOTP}
    Open SMS App    ${lo_3PO_1_IPAppium}    ${lo_3PO_1_Platfrom_Name}    ${lo_3PO_1_Platfrom_Version}    ${lo_3PO_1}
    Wait SMS    ${lo_3PO_1_Platfrom_Name}    1    ${lo_GeneralTimeOut}
    ${messages}=    Read SMS    ${lo_3PO_1_Platfrom_Name}    AIS    1
    @{OTP}=    Get Regexp Matches    @{messages}[0]    \\d\\d\\d\\d
    ${fakeOTP}=    Fake OTP    @{OTP}[0]
    Input Web Text    ${txtInputOTP}    ${fakeOTP}
    Click Web Element    ${btnOKOTP}
    sleep    2
    Element Should Be Visible    ${WrongOTP}
    AISAppiumEx.Close All Applications
    Close Browser

[F01-005]eServiceWeb-PO-Login-NotInputOtp
    Take And Define Virtual Local Configuration    ${lo_local_config_file_path}    lo_3PO_1    ${lo_parallel_timeout}
    &{#list_device_name}=    Create Dictionary    ${lo_3PO_1_#device_name}=${lo_3PO_1_#timestamp}
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    ${lo_3PO_1_Number}
    Click Web Element    ${btnGetOTP}
    Sleep    2
    Element Should Be Visible    ${btnOKOTPDisable}
    Close Browser
    Open SMS App    ${lo_3PO_1_IPAppium}    ${lo_3PO_1_Platfrom_Name}    ${lo_3PO_1_Platfrom_Version}    ${lo_3PO_1_SN}
    Clear All Unread SMS    ${lo_3PO_1_Platfrom_Name}
    AISAppiumEx.Close All Applications
    [Teardown]    Release Virtual Local Configurations    ${lo_local_config_file_path}    &{#list_device_name}

[F01-006]eServiceWeb-PO-Login-InputOtpWithCharacter
    Take And Define Virtual Local Configuration    ${lo_local_config_file_path}    lo_3PO_1    ${lo_parallel_timeout}
    &{#list_device_name}=    Create Dictionary    ${lo_3PO_1_#device_name}=${lo_3PO_1_#timestamp}
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    ${lo_3PO_1_Number}
    Click Web Element    ${btnGetOTP}
    Wait Until Element Is Enabled    ${txtInputOTP}
    Input Web Text    ${txtInputOTP}    a
    Element Text Should Be    ${lblDialogMessage}    ${MessageInputOtpWithCharacter}
    Click Web Element    ${btnDialogClose}
    Close Browser
    Open SMS App    ${lo_3PO_1_IPAppium}    ${lo_3PO_1_Platfrom_Name}    ${lo_3PO_1_Platfrom_Version}    ${lo_3PO_1_SN}
    Clear All Unread SMS    ${lo_3PO_1_Platfrom_Name}
    AISAppiumEx.Close All Applications
    [Teardown]    Release Virtual Local Configurations    ${lo_local_config_file_path}    &{#list_device_name}

[F01-007]eServiceWeb-PO-Login-CancelOtp
    Take And Define Virtual Local Configuration    ${lo_local_config_file_path}    lo_3PO_1    ${lo_parallel_timeout}
    &{#list_device_name}=    Create Dictionary    ${lo_3PO_1_#device_name}=${lo_3PO_1_#timestamp}
    Open Browser    ${eServiceURL}    ${ar_BROWSER}    remote_url=${lo_IPSelenium}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    ${lo_3PO_1_Number}
    Click Web Element    ${btnGetOTP}
    Click Web Element    ${btnCancelOtp}
    Element Text Should Be    ${txtMobileNumber}    ${EMPTY}
    Close Browser
    Open SMS App    ${lo_3PO_1_IPAppium}    ${lo_3PO_1_Platfrom_Name}    ${lo_3PO_1_Platfrom_Version}    ${lo_3PO_1_SN}
    Clear All Unread SMS    ${lo_3PO_1_Platfrom_Name}
    Close All Applications
    [Teardown]    Release Virtual Local Configurations    ${lo_local_config_file_path}    &{#list_device_name}

TestPararell1
    [Tags]    TestP
    Take And Define Virtual Local Configuration    ${gn_local_config_file_path}    lo_3PO_1    ${gn_parallel_timeout}
    &{#list_device_name}=    Create Dictionary    ${lo_3PO_1_#device_name}=${lo_3PO_1_#timestamp}
    log    ${lo_3PO_1_IPAppium}
    log    ${lo_3PO_1_Platfrom_Name}
    log    ${lo_3PO_1_Platfrom_Version}
    log    ${lo_3PO_1_SN}
    log    ${TEST_NAME}
    ${driver1}    AISAppium Open Application    http://${lo_3PO_1_IPAppium}/wd/hub    platformName=${lo_3PO_1_Platfrom_Name}    platformVersion=${lo_3PO_1_Platfrom_Version}    deviceName= any    appPackage=com.ais.mimo.eservice
    ...    appActivity=com.nextzy.allforone.view.DummyActivity    appWaitActivity=com.nextzy.allforone.view.menu.MenuActivity    udid=${lo_3PO_1_SN}
    sleep    10
    AISAppium Click Element    xpath=//android.widget.ImageView[@content-desc="eService"]
    sleep    10
    AISAppium Click Element    name=My Profile
    Comment    Mobile Set Network Connection Status    6    ${App1}
    Comment    Log    http://${lo_3PO_1_IPAppium}/wd/hub
    Comment    Open SMS App    ${lo_3PO_1_IPAppium}    ${lo_3PO_1_Platfrom_Name}    ${lo_3PO_1_Platfrom_Version}    ${lo_3PO_1_SN}
    AISAppiumEx.Close All Applications
    [Teardown]    Release Virtual Local Configurations    ${gn_local_config_file_path}    &{#list_device_name}

TestPararell2
    [Tags]    TestP
    Take And Define Virtual Local Configuration    ${gn_local_config_file_path}    lo_3PO_1    ${gn_parallel_timeout}
    &{#list_device_name}=    Create Dictionary    ${lo_3PO_1_#device_name}=${lo_3PO_1_#timestamp}
    log    ${lo_3PO_1_IPAppium}
    log    ${lo_3PO_1_Platfrom_Name}
    log    ${lo_3PO_1_Platfrom_Version}
    log    ${lo_3PO_1_SN}
    ${driver1}    AISAppium Open Application    http://${lo_3PO_1_IPAppium}/wd/hub    platformName=${lo_3PO_1_Platfrom_Name}    platformVersion=${lo_3PO_1_Platfrom_Version}    deviceName= any    appPackage=com.ais.mimo.eservice
    ...    appActivity=com.nextzy.allforone.view.DummyActivity    appWaitActivity=com.nextzy.allforone.view.menu.MenuActivity    udid=${lo_3PO_1_SN}
    sleep    10
    AISAppium Click Element    xpath=//android.widget.ImageView[@content-desc="eService"]
    sleep    10
    AISAppium Click Element    name=Package
    Comment    Mobile Set Network Connection Status    6    ${App1}
    Comment    Log    http://${lo_3PO_1_IPAppium}/wd/hub
    Comment    Open SMS App    ${lo_3PO_1_IPAppium}    ${lo_3PO_1_Platfrom_Name}    ${lo_3PO_1_Platfrom_Version}    ${lo_3PO_1_SN}
    AISAppiumEx.Close All Applications
    [Teardown]    Release Virtual Local Configurations    ${gn_local_config_file_path}    &{#list_device_name}

TestPararell3
    [Tags]    TestP
    Take And Define Virtual Local Configuration    ${gn_local_config_file_path}    lo_3PO_1    ${gn_parallel_timeout}
    &{#list_device_name}=    Create Dictionary    ${lo_3PO_1_#device_name}=${lo_3PO_1_#timestamp}
    log    ${lo_3PO_1_IPAppium}
    log    ${lo_3PO_1_Platfrom_Name}
    log    ${lo_3PO_1_Platfrom_Version}
    log    ${lo_3PO_1_SN}
    ${driver1}    AISAppium Open Application    http://${lo_3PO_1_IPAppium}/wd/hub    platformName=${lo_3PO_1_Platfrom_Name}    platformVersion=${lo_3PO_1_Platfrom_Version}    deviceName= any    appPackage=com.ais.mimo.eservice
    ...    appActivity=com.nextzy.allforone.view.DummyActivity    appWaitActivity=com.nextzy.allforone.view.menu.MenuActivity    udid=${lo_3PO_1_SN}
    sleep    10
    AISAppium Click Element    xpath=//android.widget.ImageView[@content-desc="eService"]
    sleep    10
    AISAppium Click Element    name=FAQ
    Comment    Mobile Set Network Connection Status    6    ${App1}
    Comment    Log    http://${lo_3PO_1_IPAppium}/wd/hub
    Comment    Open SMS App    ${lo_3PO_1_IPAppium}    ${lo_3PO_1_Platfrom_Name}    ${lo_3PO_1_Platfrom_Version}    ${lo_3PO_1_SN}
    AISAppiumEx.Close All Applications
    [Teardown]    Release Virtual Local Configurations    ${gn_local_config_file_path}    &{#list_device_name}
