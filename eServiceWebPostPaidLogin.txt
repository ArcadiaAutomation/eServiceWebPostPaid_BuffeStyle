*** Settings ***
Resource          Resource/PageKeywords/eServiceWebPostPaidLogin.txt
Resource          Resource/Localized/${ar_LANG}/eServiceWebPostPaidLoginMessage.txt
Resource          ../LocalConfig.txt

*** Test Cases ***
test
    [Tags]    test
    Open SMS App    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1}
    Comment    Wait SMS    ${lo_RUN_3PO_1_Platfrom_Name}    1    60
    Comment    ${messages}=    Read SMS    ${lo_RUN_3PO_1_Platfrom_Name}    AIS    1
    Comment    Log List    ${messages}
    Comment    ${temp}=    Set Variable    @{messages}[0]
    Comment    Log    ${temp}
    Comment    Log    Finish...
    Comment    ${app1}=    Open Application    http://10.239.223.104:4725/wd/hub    platformName=Android    platformVersion=5.0.2    udid=2a82ee4d
    ...    appPackage=com.ais.mimo.eservice    appActivity=com.nextzy.allforone.view.DummyActivity    appWaitActivity=com.nextzy.allforone.view.menu.MenuActivity    deviceName=10.239.223.104:4723
    Comment    sleep    3
    Comment    AppiumLibrary.Click Element    xpath=//android.widget.ImageView[@content-desc="eService"]
    Comment    sleep    3
    Comment    ${app2}=    Open Application    http://10.239.223.104:4723/wd/hub    platformName=Android    platformVersion=5.0.2    udid=2a82ee4d
    ...    appPackage=com.calea.echo    appActivity=com.calea.echo.MainActivity    deviceName=10.239.223.104:4723
    Comment    sleep    5
    Comment    Switch Application    ${app1}
    Comment    sleep    3

[F01-001]eServiceWeb-PO-Login-NumberNotComplete
    Open Browser    ${eServiceURL}    ${ar_BROWSER}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    090546798
    Click Web Element    ${btnGetOTP}
    Element Text Should Be    ${lblDialogMessage}    ${ERROR_MessageNumberNotComplete}
    Click Web Element    ${btnDialogClose}
    Close Browser

[F01-002]eServiceWeb-PO-Login-NumberDtac
    Open Browser    ${eServiceURL}    ${ar_BROWSER}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    0944835961
    Click Web Element    ${btnGetOTP}
    Wait Web Until Page Contains Element    ${ttMessage}
    Element Text Should Be    ${ttMessage}    ${ERROR_MessageNumberDtac}
    Close Browser

[F01-003]eServiceWeb-PO-Login-OtpNotcomplete
    Open Browser    ${eServiceURL}    ${ar_BROWSER}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    ${lo_RUN_3PO_1_Number}
    Click Web Element    ${btnGetOTP}
    Sleep    2
    Input Web Text    ${txtInputOTP}    123
    Element Should Not Be Visible    ${btnLoginConfirm}
    Close Browser

[F01-004]eServiceWeb-PO-Login-InputWrongOtp
    Open Browser    ${eServiceURL}    ${ar_BROWSER}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Select Language    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    ${lo_RUN_3PO_1_Number}
    Click Web Element    ${btnGetOTP}
    Comment    ${SMSOTP}    GetSMSfromMood    AIS    ${lo_RUN_3PO_1_IPAppium}    1    ${lo_RUN_3PO_1}
    Comment    ${OTP}    GetOTPinSMS    ${SMSOTP}
    Open SMS App    ${lo_RUN_3PO_1_IPAppium}    ${lo_RUN_3PO_1_Platfrom_Name}    ${lo_RUN_3PO_1_Platfrom_Version}    ${lo_RUN_3PO_1}
    Wait SMS    ${lo_RUN_3PO_1_Platfrom_Name}    1    ${lo_GeneralTimeOut}
    ${messages}=    Read SMS    ${lo_RUN_3PO_1_Platfrom_Name}    AIS    1
    @{OTP}=    Get Regexp Matches    @{messages}[0]    \\d\\d\\d\\d
    ${fakeOTP}=    Fake OTP    @{OTP}[0]
    Input Web Text    ${txtInputOTP}    ${fakeOTP}
    Click Web Element    ${btnOKOTP}
    sleep    2
    Element Should Be Visible    ${WrongOTP}
    Close Browser

[F01-005]eServiceWeb-PO-Login-NotInputOtp
    Open Browser    ${eServiceURL}    ${ar_BROWSER}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    ${lo_RUN_3PO_1_Number}
    Click Web Element    ${btnGetOTP}
    Sleep    2
    Element Should Not Be Visible    ${btnLoginConfirm}
    Close Browser

[F01-006]eServiceWeb-PO-Login-InputOtpWithCharacter
    Open Browser    ${eServiceURL}    ${ar_BROWSER}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    ${lo_RUN_3PO_1_Number}
    Click Web Element    ${btnGetOTP}
    Sleep    2
    Input Web Text    ${txtInputOTP}    a
    Element Text Should Be    ${lblDialogMessage}    ${ERROR_MessageInputOtpWithCharacter}
    Click Web Element    ${btnDialogClose}
    Close Browser

[F01-007]eServiceWeb-PO-Login-CancelOtp
    Open Browser    ${eServiceURL}    ${ar_BROWSER}
    Maximize Browser Window
    Select Frame    ${fraMainIframe}
    Click Web Element    ${btnLanguage}
    Input Web Text    ${txtMobileNumber}    ${lo_RUN_3PO_1_Number}
    Click Web Element    ${btnGetOTP}
    Sleep    2
    Click Web Element    ${btnCancelOtp}
    Element Text Should Be    ${txtMobileNumber}    ${EMPTY}
    Close Browser
